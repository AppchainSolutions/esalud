{"version":3,"file":"ConsultaVacuna-okELJ7yI.js","sources":["../../../resources/js/Pages/Consultas/ConsultaVacuna.vue"],"sourcesContent":["<script setup>\n    import AppLayout from \"@/Layouts/AppLayout.vue\";\n    import { reactive, onMounted } from \"vue\";\n    import { fetchData, handleSearchItem } from \"@/helper.js\";\n\n    defineOptions({layout: AppLayout});\n\n    const state = reactive({\n        endpoints: [\"area\", \"ceco\", \"empresa\", \"planta\", \"unidad\"],\n\n        headers: [\n            {title: \"RUT\", align: \"center\", sortable: true, key: \"rut\"},\n            {title: \"Nombre\", align: \"center\", sortable: true, key: \"nombre\"},\n            {\n                title: \"Apellidos\",\n                sortable: true,\n                align: \"center\",\n                key: \"apellidos\",\n            },\n            {\n                title: \"Empresa\",\n                sortable: true,\n                align: \"center\",\n                key: \"empresa.descripcion\",\n            },\n            {\n                title: \"Tipo de Vacuna\",\n                sortable: true,\n                align: \"center\",\n                key: \"tipo_vacuna\",\n            },\n            {\n                title: \"Vacuna\",\n                sortable: true,\n                align: \"center\",\n                key: \"vacuna\",\n            },\n            {\n                title: \"Fecha vacuna\",\n                sortable: true,\n                align: \"center\",\n                key: \"fecha_vacuna\",\n            },\n\n            {title: \"Acciones\", align: \"center\", key: \"actions\"},\n        ],\n\n        searchQuery: {\n            activo: \"true\",\n            area: null,\n            ceco: null,\n            empresa: null,\n            planta: null,\n            rut: null,\n            unidad: null,\n        },\n\n        itemsView: {\n            tipo_vacuna: \"\",\n            vacuna: \"\",\n            fecha_vacuna: \"\",\n        },\n        rutRules: [\n            (value) => {\n                const regex = /^[0-9]+[-|‐]{1}[0-9kK]{1}$/;\n                if (!regex.test(value)) {\n                    return false;\n                }\n\n                // Separar el número y el dígito verificador\n                let splitrut = value.split(\"-\");\n                let num = splitrut[0];\n                let dv = splitrut[1].toLowerCase();\n\n                // Calcular el dígito verificador esperado\n                let m = 0;\n                let s = 1;\n                for (; num; num = Math.floor(num / 10)) {\n                    s = (s + (num % 10) * (9 - (m++ % 6))) % 11;\n                }\n                let dvEsperado = s ? s - 1 : \"k\";\n                let validate = dv === dvEsperado;\n\n                if (validate)\n                    return true;\n                return \"El rut es incorrecto\";\n            },\n        ],\n        dialog: false,\n        tableItems: [],\n        formItems: [],\n        editedIndex: -1,\n        loadingSearch: false,\n        list: [],\n        valid: null,\n        formTitle: \"Consulta Vacuna\",\n        urlSearch: \"/consulta/vacuna/search\",\n    });\n\n//**********\\\\\\\\  LIFE CYCLE HOOKS ////*************/\n    /**\n     * Initializes the component by calling the 'initialize' function.\n     *\n     * @function onMounted\n     * @returns {void}\n     */\n    onMounted(async () => {\n        state.list = await fetchData(state.endpoints);\n    });\n\n//**********\\\\\\\\ METHODS ////*************/\n\n    function VerDetalles(item) {\n        state.itemsView = {...item};\n        state.dialog = true;\n    }\n    function close() {\n        state.dialog = false;\n    }\n\n//**********\\\\\\\\  CRUD ////*************/\n\n    const handleSearch = async () => {\n        var res = await handleSearchItem(state);\n        console.log(res);\n    };\n</script>\n\n<template>\n    <v-container fluid>\n        <v-card>\n            <v-card-title>\n                <v-toolbar flat>\n                    <v-toolbar-title>{{ state.formTitle }}</v-toolbar-title>\n                    <v-spacer></v-spacer>\n                </v-toolbar>\n            </v-card-title>\n\n            <v-card-text>\n                <v-sheet\n                    color=\"white\"\n                    :elevation=\"4\"\n                    :class=\"'rounded-lg ma-2 pa-2'\"\n                    >\n                    <!-- SEARCH -->\n                    <v-container fluid>\n                        <v-card-text>\n                            <v-row>\n                                <v-col>\n                                    <v-text-field\n                                        clearable\n                                        label=\"Rut\"\n                                        variant=\"underlined\"\n                                        :rules=\"state.rutRules\"\n                                        v-model=\"state.searchQuery.rut\"\n                                        ></v-text-field>\n                                    <v-select\n                                        clearable\n                                        label=\"Empresa\"\n                                        variant=\"underlined\"\n                                        v-model=\"state.searchQuery.empresa\"\n                                        :items=\"state.list.empresa\"\n                                        item-title=\"descripcion\"\n                                        item-value=\"id\"\n                                        ></v-select>\n                                    <v-select\n                                        clearable\n                                        label=\"Unidad\"\n                                        variant=\"underlined\"\n                                        v-model=\"state.searchQuery.unidad\"\n                                        :items=\"state.list.unidad\"\n                                        item-title=\"descripcion\"\n                                        item-value=\"id\"\n                                        ></v-select>\n                                    <v-select\n                                        clearable\n                                        label=\"Area\"\n                                        v-model=\"state.searchQuery.area\"\n                                        variant=\"underlined\"\n                                        :items=\"state.list.area\"\n                                        item-title=\"descripcion\"\n                                        item-value=\"id\"\n                                        ></v-select>\n                                    <v-select\n                                        clearable\n                                        label=\"Area (cecos)\"\n                                        v-model=\"state.searchQuery.ceco\"\n                                        variant=\"underlined\"\n                                        :items=\"state.list.ceco\"\n                                        item-title=\"descripcion\"\n                                        item-value=\"id\"\n                                        ></v-select>\n                                </v-col>\n                                <v-col>\n                                    <v-text-field\n                                        clearable\n                                        label=\"Vacuna\"\n                                        variant=\"underlined\"\n                                        type=\"text\"\n                                        v-model=\"state.searchQuery.vacuna\"\n                                        ></v-text-field>\n                                    <v-switch\n                                        v-model=\"state.searchQuery.activo\"\n                                        hide-details\n                                        true-value=\"true\"\n                                        false-value=\"false\"\n                                        class=\"ml-4 mb-4\"\n                                        variant=\"underlined\"\n                                        color=\"green-darken-3\"\n                                        inset\n                                        label=\"Activo\"\n                                        ></v-switch>\n                                </v-col>\n                            </v-row>\n                        </v-card-text>\n                        <v-card-actions>\n                            <v-btn\n                                prepend-icon=\"mdi-file-search\"\n                                variant=\"tonal\"\n                                :loading=\"state.loadingSearch\"\n                                color=\"#009AA4\"\n                                @click=\"handleSearch\"\n                                >\n                                Buscar\n                            </v-btn>\n\n                            <v-btn\n                                prepend-icon=\"mdi-microsoft-excel\"\n                                variant=\"tonal\"\n                                color=\"#009AA4\"\n                                >\n                                <download-excel\n                                    :data=\"state.tableItems\"\n                                    name=\"consulta_vacunas.xls\"\n                                    >\n                                    Bajar archivo\n                                </download-excel>\n                            </v-btn>\n                        </v-card-actions>\n                    </v-container>\n\n                    <!-- TABLA -->\n                    <v-container fluid>\n                        <v-data-table\n                            :headers=\"state.headers\"\n                            :items=\"state.tableItems\"\n                            :sort-by=\"[{ key: 'apellidos', order: 'asc' }]\"\n                            >\n                            <template v-slot:item.actions=\"{ item }\">\n                                <v-tooltip text=\"Ver detalles\" location=\"top\">\n                                    <template v-slot:activator=\"{ props }\">\n                                        <v-btn\n                                            v-bind=\"props\"\n                                            density=\"compact\"\n                                            color=\"#009AA4\"\n                                            class=\"mr-2 ml-2\"\n                                            variant=\"tonal\"\n                                            :icon=\"'mdi-eye'\"\n                                            @click=\"VerDetalles(item)\"\n                                            ></v-btn>\n                                    </template>\n                                </v-tooltip>\n                            </template>\n                        </v-data-table>\n                    </v-container>\n                </v-sheet>\n            </v-card-text>\n        </v-card>\n\n        <!-- state.searchQuery -->\n        <v-container>\n            <v-dialog v-model=\"state.dialog\">\n                <v-sheet elevation=\"4\" class=\"ma-4 pa-4\">\n                    <v-card>\n                        <v-form readonly>\n                            <v-sheet elevation=\"2\" class=\"ma-2 pa-2\">\n                                <v-card-title>\n                                    <span class=\"text-h5\">\n                                        Consulta de Vacunas\n                                    </span>\n                                </v-card-title>\n                            </v-sheet>\n                            <v-card-text>\n                                <v-row>\n                                    <v-col>\n                                        <v-text-field\n                                            v-model=\"\n                                            state.itemsView.fecha_vacuna\n                                            \"\n                                            label=\"Fecha Vacuna\"\n                                            type=\"date\"\n                                            variant=\"underlined\"\n                                            readonly\n                                            ></v-text-field>\n\n                                        <v-text-field\n                                            v-model=\"\n                                            state.itemsView.tipo_vacuna\n                                            \"\n                                            type=\"text\"\n                                            label=\"Tipo de vacuna\"\n                                            variant=\"underlined\"\n                                            readonly\n                                            ></v-text-field>\n                                    </v-col>\n                                    <v-col>\n                                        <v-text-field\n                                            v-model=\"state.itemsView.vacuna\"\n                                            readonly\n                                            type=\"text\"\n                                            label=\"Vacuna\"\n                                            variant=\"underlined\"\n                                            ></v-text-field>\n                                        <v-text-field\n                                            v-model=\"state.itemsView.comentario\"\n                                            readonly\n                                            type=\"text\"\n                                            label=\"Comentario\"\n                                            variant=\"underlined\"\n                                            ></v-text-field>\n                                    </v-col>\n                                </v-row>\n                            </v-card-text>\n\n                            <v-sheet elevation=\"2\" class=\"ma-2 pa-2\">\n                                <v-card-actions>\n                                    <v-btn\n                                        class=\"mr-2 ml-2\"\n                                        color=\"#009AA4\"\n                                        text=\"Cerrar\"\n                                        variant=\"tonal\"\n                                        @click=\"close()\"\n                                        ></v-btn>\n                                </v-card-actions>\n                            </v-sheet>\n                        </v-form>\n                    </v-card>\n                </v-sheet>\n            </v-dialog>\n        </v-container>\n    </v-container>\n</template>\n"],"names":[],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}