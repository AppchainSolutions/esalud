{"version":3,"file":"ApiTokenManager-CEnMuvrY.js","sources":["../../../resources/js/Pages/API/Partials/ApiTokenManager.vue"],"sourcesContent":["<script setup>\nimport { ref } from 'vue';\nimport { useForm } from '@inertiajs/vue3';\nimport ActionMessage from '@/Components/ActionMessage.vue';\nimport ActionSection from '@/Components/ActionSection.vue';\nimport Checkbox from '@/Components/Checkbox.vue';\nimport ConfirmationModal from '@/Components/ConfirmationModal.vue';\nimport DangerButton from '@/Components/DangerButton.vue';\nimport DialogModal from '@/Components/DialogModal.vue';\nimport FormSection from '@/Components/FormSection.vue';\nimport InputError from '@/Components/InputError.vue';\nimport InputLabel from '@/Components/InputLabel.vue';\nimport PrimaryButton from '@/Components/PrimaryButton.vue';\nimport SecondaryButton from '@/Components/SecondaryButton.vue';\nimport SectionBorder from '@/Components/SectionBorder.vue';\nimport TextInput from '@/Components/TextInput.vue';\n\nconst props = defineProps({\n    tokens: Array,\n    availablePermissions: Array,\n    defaultPermissions: Array,\n});\n\nconst createApiTokenForm = useForm({\n    name: '',\n    permissions: props.defaultPermissions,\n});\n\nconst updateApiTokenForm = useForm({\n    permissions: [],\n});\n\nconst deleteApiTokenForm = useForm({});\n\nconst displayingToken = ref(false);\nconst managingPermissionsFor = ref(null);\nconst apiTokenBeingDeleted = ref(null);\n\nconst createApiToken = () => {\n    createApiTokenForm.post(route('api-tokens.store'), {\n        preserveScroll: true,\n        onSuccess: () => {\n            displayingToken.value = true;\n            createApiTokenForm.reset();\n        },\n    });\n};\n\nconst manageApiTokenPermissions = (token) => {\n    updateApiTokenForm.permissions = token.abilities;\n    managingPermissionsFor.value = token;\n};\n\nconst updateApiToken = () => {\n    updateApiTokenForm.put(route('api-tokens.update', managingPermissionsFor.value), {\n        preserveScroll: true,\n        preserveState: true,\n        onSuccess: () => (managingPermissionsFor.value = null),\n    });\n};\n\nconst confirmApiTokenDeletion = (token) => {\n    apiTokenBeingDeleted.value = token;\n};\n\nconst deleteApiToken = () => {\n    deleteApiTokenForm.delete(route('api-tokens.delete', apiTokenBeingDeleted.value), {\n        preserveScroll: true,\n        preserveState: true,\n        onSuccess: () => (apiTokenBeingDeleted.value = null),\n    });\n};\n</script>\n\n<template>\n    <div>\n        <!-- Generate API Token -->\n        <FormSection @submitted=\"createApiToken\">\n            <template #title>\n                Create API Token\n            </template>\n\n            <template #description>\n                API tokens allow third-party services to authenticate with our application on your behalf.\n            </template>\n\n            <template #form>\n                <!-- Token Name -->\n                <div class=\"col-span-6 sm:col-span-4\">\n                    <InputLabel for=\"name\" value=\"Name\" />\n                    <TextInput\n                        id=\"name\"\n                        v-model=\"createApiTokenForm.name\"\n                        type=\"text\"\n                        class=\"mt-1 block w-full\"\n                        autofocus\n                    />\n                    <InputError :message=\"createApiTokenForm.errors.name\" class=\"mt-2\" />\n                </div>\n\n                <!-- Token Permissions -->\n                <div v-if=\"availablePermissions.length > 0\" class=\"col-span-6\">\n                    <InputLabel for=\"permissions\" value=\"Permissions\" />\n\n                    <div class=\"mt-2 grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        <div v-for=\"permission in availablePermissions\" :key=\"permission\">\n                            <label class=\"flex items-center\">\n                                <Checkbox v-model:checked=\"createApiTokenForm.permissions\" :value=\"permission\" />\n                                <span class=\"ms-2 text-sm text-gray-600\">{{ permission }}</span>\n                            </label>\n                        </div>\n                    </div>\n                </div>\n            </template>\n\n            <template #actions>\n                <ActionMessage :on=\"createApiTokenForm.recentlySuccessful\" class=\"me-3\">\n                    Created.\n                </ActionMessage>\n\n                <PrimaryButton :class=\"{ 'opacity-25': createApiTokenForm.processing }\" :disabled=\"createApiTokenForm.processing\">\n                    Create\n                </PrimaryButton>\n            </template>\n        </FormSection>\n\n        <div v-if=\"tokens.length > 0\">\n            <SectionBorder />\n\n            <!-- Manage API Tokens -->\n            <div class=\"mt-10 sm:mt-0\">\n                <ActionSection>\n                    <template #title>\n                        Manage API Tokens\n                    </template>\n\n                    <template #description>\n                        You may delete any of your existing tokens if they are no longer needed.\n                    </template>\n\n                    <!-- API Token List -->\n                    <template #content>\n                        <div class=\"space-y-6\">\n                            <div v-for=\"token in tokens\" :key=\"token.id\" class=\"flex items-center justify-between\">\n                                <div class=\"break-all\">\n                                    {{ token.name }}\n                                </div>\n\n                                <div class=\"flex items-center ms-2\">\n                                    <div v-if=\"token.last_used_ago\" class=\"text-sm text-gray-400\">\n                                        Last used {{ token.last_used_ago }}\n                                    </div>\n\n                                    <button\n                                        v-if=\"availablePermissions.length > 0\"\n                                        class=\"cursor-pointer ms-6 text-sm text-gray-400 underline\"\n                                        @click=\"manageApiTokenPermissions(token)\"\n                                    >\n                                        Permissions\n                                    </button>\n\n                                    <button class=\"cursor-pointer ms-6 text-sm text-red-500\" @click=\"confirmApiTokenDeletion(token)\">\n                                        Delete\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                    </template>\n                </ActionSection>\n            </div>\n        </div>\n\n        <!-- Token Value Modal -->\n        <DialogModal :show=\"displayingToken\" @close=\"displayingToken = false\">\n            <template #title>\n                API Token\n            </template>\n\n            <template #content>\n                <div>\n                    Please copy your new API token. For your security, it won't be shown again.\n                </div>\n\n                <div v-if=\"$page.props.jetstream.flash.token\" class=\"mt-4 bg-gray-100 px-4 py-2 rounded font-mono text-sm text-gray-500 break-all\">\n                    {{ $page.props.jetstream.flash.token }}\n                </div>\n            </template>\n\n            <template #footer>\n                <SecondaryButton @click=\"displayingToken = false\">\n                    Close\n                </SecondaryButton>\n            </template>\n        </DialogModal>\n\n        <!-- API Token Permissions Modal -->\n        <DialogModal :show=\"managingPermissionsFor != null\" @close=\"managingPermissionsFor = null\">\n            <template #title>\n                API Token Permissions\n            </template>\n\n            <template #content>\n                <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div v-for=\"permission in availablePermissions\" :key=\"permission\">\n                        <label class=\"flex items-center\">\n                            <Checkbox v-model:checked=\"updateApiTokenForm.permissions\" :value=\"permission\" />\n                            <span class=\"ms-2 text-sm text-gray-600\">{{ permission }}</span>\n                        </label>\n                    </div>\n                </div>\n            </template>\n\n            <template #footer>\n                <SecondaryButton @click=\"managingPermissionsFor = null\">\n                    Cancel\n                </SecondaryButton>\n\n                <PrimaryButton\n                    class=\"ms-3\"\n                    :class=\"{ 'opacity-25': updateApiTokenForm.processing }\"\n                    :disabled=\"updateApiTokenForm.processing\"\n                    @click=\"updateApiToken\"\n                >\n                    Save\n                </PrimaryButton>\n            </template>\n        </DialogModal>\n\n        <!-- Delete Token Confirmation Modal -->\n        <ConfirmationModal :show=\"apiTokenBeingDeleted != null\" @close=\"apiTokenBeingDeleted = null\">\n            <template #title>\n                Delete API Token\n            </template>\n\n            <template #content>\n                Are you sure you would like to delete this API token?\n            </template>\n\n            <template #footer>\n                <SecondaryButton @click=\"apiTokenBeingDeleted = null\">\n                    Cancel\n                </SecondaryButton>\n\n                <DangerButton\n                    class=\"ms-3\"\n                    :class=\"{ 'opacity-25': deleteApiTokenForm.processing }\"\n                    :disabled=\"deleteApiTokenForm.processing\"\n                    @click=\"deleteApiToken\"\n                >\n                    Delete\n                </DangerButton>\n            </template>\n        </ConfirmationModal>\n    </div>\n</template>\n"],"names":["createApiTokenForm","useForm","__props","updateApiTokenForm","deleteApiTokenForm","displayingToken","ref","managingPermissionsFor","apiTokenBeingDeleted","createApiToken","manageApiTokenPermissions","token","updateApiToken","confirmApiTokenDeletion","deleteApiToken"],"mappings":"29CAuBA,MAAMA,EAAqBC,EAAQ,CAC/B,KAAM,GACN,YARUC,EAQS,kBACvB,CAAC,EAEKC,EAAqBF,EAAQ,CAC/B,YAAa,CAAE,CACnB,CAAC,EAEKG,EAAqBH,EAAQ,CAAA,CAAE,EAE/BI,EAAkBC,EAAI,EAAK,EAC3BC,EAAyBD,EAAI,IAAI,EACjCE,EAAuBF,EAAI,IAAI,EAE/BG,EAAiB,IAAM,CACzBT,EAAmB,KAAK,MAAM,kBAAkB,EAAG,CAC/C,eAAgB,GAChB,UAAW,IAAM,CACbK,EAAgB,MAAQ,GACxBL,EAAmB,MAAK,CAC3B,CACT,CAAK,CACL,EAEMU,EAA6BC,GAAU,CACzCR,EAAmB,YAAcQ,EAAM,UACvCJ,EAAuB,MAAQI,CACnC,EAEMC,EAAiB,IAAM,CACzBT,EAAmB,IAAI,MAAM,oBAAqBI,EAAuB,KAAK,EAAG,CAC7E,eAAgB,GAChB,cAAe,GACf,UAAW,IAAOA,EAAuB,MAAQ,IACzD,CAAK,CACL,EAEMM,EAA2BF,GAAU,CACvCH,EAAqB,MAAQG,CACjC,EAEMG,EAAiB,IAAM,CACzBV,EAAmB,OAAO,MAAM,oBAAqBI,EAAqB,KAAK,EAAG,CAC9E,eAAgB,GAChB,cAAe,GACf,UAAW,IAAOA,EAAqB,MAAQ,IACvD,CAAK,CACL"}