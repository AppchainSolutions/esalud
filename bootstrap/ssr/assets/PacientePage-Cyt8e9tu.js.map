{"version":3,"file":"PacientePage-Cyt8e9tu.js","sources":["../../../resources/js/Pages/PacientePage.vue"],"sourcesContent":["<script setup>\nimport AppLayout from \"../Layouts/AppLayout.vue\";\nimport { reactive, onMounted } from \"vue\";\nimport { useLogger } from \"vue-logger-plugin\";\nimport { fetchAllData, handleSearchItem } from \"../helper.js\";\nimport TableAction from \"./SubPages/Componentes/TableAction.vue\";\nimport { router } from '@inertiajs/vue3';\n\ndefineOptions({ layout: AppLayout });\n\n//const store = useDataStore();\nconst logger = useLogger();\nconst state = reactive({\n    \n    endpoints: [\n        \"calles\",\n        \"estados_civiles\",\n        \"establecimientos_educacionales\",\n        \"generos\",\n        \"grupos_sanguineos\",\n        \"nacionalidades\",\n        \"niveles_instruccion\",\n        \"previsiones\",\n        \"pueblos_originarios\",\n        \"religiones\",\n    ],\n\n    headers: [\n        { title: \"Rut\", align: \"center\", sortable: true, key: \"rut\" },\n        { title: \"Nombre\", align: \"center\", sortable: true, key: \"nombre\" },\n        {\n            title: \"Apellidos\",\n            align: \"center\",\n            sortable: true,\n            key: \"apellidos\",\n        },\n        {\n            title: \"Edad\",\n            align: \"center\",\n            sortable: true,\n            key: \"edad\",\n        },\n        {\n            title: \"Telefono contacto\",\n            align: \"center\",\n            sortable: true,\n            key: \"telefono1\",\n        },\n        { title: \"Acciones\", sortable: false, align: \"center\", key: \"actions\" },\n    ],\n\n    searchQuery: {\n        id: null,\n        rut: null,\n        rut_responsable: null,\n        establecimiento_educacional_id: null,\n    },\n\n    config: {\n        formName: \"frmPacientes\",\n        formItems: [],\n        editedIndex: -1,\n        loading: false,\n        tableItems: [],\n        formCrear: \"Nuevo Paciente\",\n        formEdit: \"Editar datos del Paciente\",\n        formTitle: \"Gestión de Pacientes\",\n        list: [],\n        route: \"paciente\",\n    },\n});\n\n/**\n * Fetches all data from the specified endpoints and updates the list configuration.\n * Logs the retrieved endpoints using the logger.\n */\nonMounted(async () => {\n    try {\n        state.config.list = await fetchAllData(state.endpoints);\n    } catch (error) {\n        logger.error(\"Error loading endpoints:\", error);\n    }\n});\n\n/**\n * Initiates a search operation using the current search query and route.\n * Updates the table items with the search results and manages the loading state.\n * Logs the search query and the retrieved data.\n *\n * @returns {Promise<void>}\n */\nasync function buscar() {\n    state.config.loading = true;\n    state.config.tableItems = await handleSearchItem(\n        state.searchQuery,\n        state.config.route,\n    );\n    state.config.loading = false;\n}\n\n/**\n * Guarda la información de un formulario en un objeto formData.\n *\n * @description Itera sobre los elementos del formulario y los agrega al objeto formData.\n *              Luego, puedes manejar formData como desees, por ejemplo, enviándolo a una API.\n */\n// async function saveForm() {\n//     const formData = {};\n//     this.formItems.forEach((item) => {\n//         formData[item.name] = item.value;\n//     });\n//     console.log(formData); // Aquí puedes enviar formData a tu API o manejarlo como necesites\n// }\n\nconst formCreate = async () => {\n    try {\n        const result = await router.get('paciente/create', { data: state.config.formName });\n        logger.log('result', result);\n    } catch (error) {\n        logger.error(\"Error loading form items:\", error);\n    }\n};\n</script>\n\n<template>\n    <v-sheet :elevation=\"4\" :class=\"'rounded-lg ma-2 pa-2'\">\n        <v-expansion-panels>\n            <v-expansion-panel title=\"Ficha de Pacientes\" id=\"ficha\" color=\"#009AA4\">\n                <v-expansion-panel-text>\n                    <v-form fast-fail @submit.prevent>\n                        <v-row>\n                            <v-col>\n                                <v-text-field v-model=\"state.searchQuery.rut\" label=\"Rut del paciente * (12345678-9)\"\n                                    class=\"ma-2\" type=\"text\" variant=\"underlined\" clearable></v-text-field>\n\n                                <v-text-field v-model=\"state.searchQuery.rut_responsable\" label=\"Rut persona encargada\"\n                                    class=\"ma-2\" type=\"text\" variant=\"underlined\" clearable></v-text-field>\n                            </v-col>\n                            <v-col>\n                                <v-select :items=\"state.config.list\n                                        .establecimientos_educacionales\n                                    \" item-title=\"descripcion\" item-value=\"id\" v-model=\"state.searchQuery\n                                            .establecimiento_educacional_id\n                                        \" clearable label=\"Establecimiento Educacional\" class=\"ma-2\" variant=\"underlined\"\n                                    single />\n                            </v-col>\n                        </v-row>\n\n                        <v-row>\n                            <v-btn prepend-icon=\"mdi-file-search\" variant=\"tonal\" class=\"ma-4\" color=\"#009AA4\"\n                                type=\"submit\" @click=\"buscar\" :loading=\"state.config.loading\">\n                                Buscar\n                            </v-btn>\n\n                            <v-btn prepend-icon=\"mdi-cloud-download\" variant=\"tonal\" class=\"ma-4\" color=\"#009AA4\">\n                                <download-excel :data=\"state.tableItems\" name=\"consulta_paciente.xls\">\n                                    Bajar archivo\n                                </download-excel>\n                            </v-btn>\n                        </v-row>\n                    </v-form>\n                </v-expansion-panel-text>\n            </v-expansion-panel>\n        </v-expansion-panels>\n\n        <v-sheet color=\"white\" :elevation=\"4\" :class=\"'rounded-lg mt-4'\">\n            <v-data-table :headers=\"state.headers\" :items=\"state.config.tableItems\">\n                <template v-slot:top>\n                    <v-toolbar flat>\n                        <v-btn icon=\"mdi-account-multiple-plus\" variant=\"tonal\" class=\"ma-2\" color=\"#009AA4\"\n                            @click=\"formCreate\">\n                        </v-btn>\n                    </v-toolbar>\n                </template>\n\n                <template v-slot:item.actions=\"{ item }\">\n                    <table-action :items=\"item\" :icon=\"'mdi-stethoscope'\" :title=\"'Ficha Medica'\"\n                        :action-type=\"'editarFichaMedica'\" />\n                    <table-action :items=\"item\" :icon=\"'mdi-account-edit-outline'\" :title=\"'Ficha Personal'\"\n                        :action-type=\"'editarFichaPersonal'\" />\n                    <table-action :items=\"item\" :icon=\"'mdi-delete-outline'\" :title=\"'Borrar registro'\"\n                        :action-type=\"'eliminarRegistro'\" />\n                </template>\n            </v-data-table>\n        </v-sheet>\n    </v-sheet>\n</template>\n"],"names":[],"mappings":"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"}