{"version":3,"file":"PacientePage-Dsd-xId8.js","sources":["../../../resources/js/Pages/PacientePage.vue"],"sourcesContent":["<script setup>\nimport AppLayout from \"@/Layouts/AppLayout.vue\";\nimport { reactive, ref, onMounted, computed } from \"vue\";\nimport { useLogger } from \"vue-logger-plugin\";\nimport { useDataStore } from \"@/store.js\";\nimport DataTable from \"./SubPages/Componentes/DataTable.vue\";\nimport {\n    fetchAllData,\n    handleRemoveItem,\n    handleSearchItem,\n    handleStoreItem,\n    handleEditItem,\n    closeForm,\n    openToCreate,\n    openToEdit,\n} from \"@/helper.js\";\n\ndefineOptions({ layout: AppLayout });\n\n//const store = useDataStore();\nconst logger = useLogger();\nconst state = reactive({\n    endpoints: [\n        \"calles\",\n        \"estados_civiles\",\n        \"establecimientos_educacionales\",\n        \"generos\",\n        \"grupos_sanguineos\",\n        \"nacionalidades\",\n        \"niveles_instruccion\",\n        \"previsiones\",\n        \"pueblos_originarios\",\n        \"religiones\",\n    ],\n\n    headers: [\n        { title: \"Rut\", align: \"center\", sortable: true, key: \"rut\" },\n        { title: \"Nombre\", align: \"center\", sortable: true, key: \"nombre\" },\n        {\n            title: \"Apellidos\",\n            align: \"center\",\n            sortable: true,\n            key: \"apellidos\",\n        },\n        {\n            title: \"Edad\",\n            align: \"center\",\n            sortable: true,\n            key: \"edad\",\n        },\n        {\n            title: \"Telefono contacto\",\n            align: \"center\",\n            sortable: true,\n            key: \"telefono1\",\n        },\n        { title: \"Acciones\", sortable: false, align: \"center\", key: \"actions\" },\n    ],\n    tableItems: [],\n\n    formFields: [\n        {\n            name: \"field1\",\n            label: \"Field 1\",\n            rules: [(v) => !!v || \"Field 1 is required\"],\n        },\n        //  { name: 'field2', label: 'Field 2', rules: [(v) => !!v || 'Field 2 is required'] },\n        //  { name: 'field3', label: 'Field 3', rules: [(v) => !!v || 'Field 3 is required'] },\n        // Add all fields that should be checked\n    ],\n\n    /*   'apellidos',\n      'apellidos_responsable',\n      'calle_id',\n      'calle_responsable_id',\n      'ciudad_responsable',\n      'ciudad',\n      'comunidad_lgbtq',\n      'comunidad_lgbtq_responsable',\n      'credencial_discapacidad_responsable',\n      'credencial_discapacidad',\n      'direccion_responsable',\n      'direccion',\n      'donante_responsable',\n      'donante',\n      'edad_responsable',\n      'edad',\n      'email_responsable',\n      'email',\n      'establecimiento_educacional_id',\n      'estado_civil_id',\n      'estado_civil_responsable_id',\n      'fecha_nacimiento_responsable',\n      'fecha_nacimiento',\n      'genero_id',\n      'genero_responsable_id',\n      'grupo_sanguineo_id',\n      'grupo_sanguineo_responsable_id',\n      'nacionalidad_id',\n      'nacionalidad_responsable_id',\n      'nivel_instruccion_id',\n      'nivel_instruccion_responsable_id',\n      'nombre_responsable',\n      'nombre',\n      'ocupacion_responsable',\n      'ocupacion',\n      'parentesco_responsable',\n      'password',\n      'pertenece_pie',\n      'prevision_id',\n      'prevision_responsable_id',\n      'profesor',\n      'pueblo_originario_id',\n      'pueblo_originario_responsable_id',\n      'religion_id',\n      'religion_responsable_id',\n      'rut_responsable',\n      'rut',\n      'telefono_responsable',\n      'telefono1',\n      'telefono2',*/\n\n    editedItem: {\n        apellidos: null,\n        apellidos_responsable: null,\n        calles_id: null,\n        calles_responsable_id: null,\n        ciudad_responsable: null,\n        ciudad: null,\n        comunidad_lgbtq: null,\n        comunidad_lgbtq_responsable: null,\n        credencial_discapacidad_responsable: null,\n        credencial_discapacidad: null,\n        direccion_responsable: null,\n        direccion: null,\n        donante_responsable: null,\n        donante: null,\n        edad_responsable: null,\n        edad: null,\n        email_responsable: null,\n        email: null,\n        establecimiento_educacional_id: null,\n        estado_civil_id: null,\n        estado_civil_responsable_id: null,\n        fecha_nacimiento_responsable: null,\n        fecha_nacimiento: null,\n        genero_id: null,\n        genero_responsable_id: null,\n        grupo_sanguineo_id: null,\n        grupo_sanguineo_responsable_id: null,\n        nacionalidad_id: null,\n        nacionalidad_responsable_id: null,\n        nivel_instruccion_id: null,\n        nivel_instruccion_responsable_id: null,\n        nombre_responsable: null,\n        nombre: null,\n        ocupacion_responsable: null,\n        ocupacion: null,\n        parentesco_responsable: null,\n        password: null,\n        pertenece_pie: null,\n        prevision_id: null,\n        prevision_responsable_id: null,\n        profesor: null,\n        pueblo_originario_id: null,\n        pueblo_originario_responsable_id: null,\n        religion_id: null,\n        religion_responsable_id: null,\n        rut_responsable: null,\n        rut: null,\n        telefono_responsable: null,\n        telefono1: null,\n        telefono2: null,\n    },\n    searchQuery: {\n        id: null,\n        rut: null,\n        rut_responsable: null,\n        establecimiento_educacional_id: null,\n    },\n\n    config: {\n        editedIndex: -1,\n        dialog: false,\n        loading: false,\n        editedIndex: -1,\n        formCrear: \"Nuevo Paciente\",\n        formEdit: \"Editar datos del Paciente\",\n        formItems: [],\n        formTitle: \"GestiÃ³n de Pacientes\",\n        list: [],\n        route: \"paciente\",\n    },\n});\n\nonMounted(async () => {\n    const result = await fetchAllData(state.endpoints);\n    state.config.list = result;\n    logger.info(\"Endpoints:\", result);\n});\n\nconst handleFormCreate = () => {\n    console.info(\"Form Create:\");\n    //openToCreate(state);\n};\nfunction handleFichaPersonal(item) {\n    logger.log(\"Ficha Personal event triggered\", item);\n}\n\nfunction handleAtencionesDiarias(item) {\n    logger.log(\"Atenciones Diarias event triggered\", item);\n}\nconst buscar = async () => {\n    logger.info(\"Buscar\", state.searchQuery);\n    state.config.loading = true;\n    await handleSearchItem(state.searchQuery, state.config.route);\n    state.config.loading = false;\n};\nconst editedItemTitle = computed(() =>\n    state.config.editedIndex === -1 ? state.formCrear : state.formEdit,\n);\n\nconst calcEdad = (fecNac) => {\n    let now = new Date();\n    let birthDate = new Date(fecNac);\n    let age = now.getFullYear() - birthDate.getFullYear();\n    return age;\n};\n\nconst handleInputChange = () => {\n    let fecNac = state.editedItem.fecha_nacimiento;\n    let age = calcEdad(fecNac);\n    state.editedItem.edad = ref(age);\n};\n\n/*\nfunction fichaMedica(item) {\n    store.selected = item;\n    try {\n        router.get(\"ficha-medica\");\n    } catch (error) {\n        console.error(\n            '\"An error occurred while fetching daily attention data.\"',\n        );\n    }\n}\nfunction fichaPersonal(item) {\n    openToEdit(state, item);\n    handleInputChange();\n}\nfunction close() {\n    closeForm(state);\n}\n\nfunction submit() {\n  // Access the form data from the state\n  const formData = this.state.editedItem;\n  console.logger('Form Data:', formData);\n\n  // Perform the create or update operation\n  //this.storeItems();\n}, \n\nmethods: {\n  storeItems() {\n    return this.state.editedIndex > -1 ? this.update() : this.create();\n  },\n  create() {\n    console.logger('create', this.state);\n    // Handle create operation\n  },\n  update() {\n    console.logger('update', this.state);\n    // Handle update operation\n  },\n  close() {\n    this.dialogger = false;\n  },\n},\n\n\n\nfunction openFormCreate() {\n\n}\n\nfunction storeItems() {\n    return state.editedIndex > -1 ? update() : create();\n}\n\nconst create = async () => {\n    console.logger(\"create\", state);\n    await handleStoreItem(state);\n    closeForm(state);\n};\n\nfunction fichaPersonal(item) {\n    openToEdit(state, item);\n    handleInputChange();\n}\n\nconst update = async () => {\n    await handleEditItem(state);\n    closeForm(state);\n};\n\nconst remove = async (item) => {\n    handleRemoveItem(state, item);*/\n</script>\n\n<template>\n    <v-sheet :elevation=\"4\" :class=\"'rounded-lg ma-2 pa-2'\">\n        <v-expansion-panels>\n            <v-expansion-panel title=\"Ficha de Pacientes\" color=\"#009AA4\">\n                <v-expansion-panel-text>\n                    <v-form fast-fail @submit.prevent>\n                        <v-row>\n                            <v-col>\n                                <v-text-field\n                                    v-model=\"state.searchQuery.rut\"\n                                    label=\"Rut del paciente * (12345678-9)\"\n                                    class=\"ma-2\"\n                                    type=\"text\"\n                                    variant=\"underlined\"\n                                    clearable\n                                ></v-text-field>\n\n                                <v-text-field\n                                    v-model=\"state.searchQuery.rut_responsable\"\n                                    label=\"Rut persona encargada\"\n                                    class=\"ma-2\"\n                                    type=\"text\"\n                                    variant=\"underlined\"\n                                    clearable\n                                ></v-text-field>\n                            </v-col>\n                            <v-col>\n                                <v-select\n                                    :items=\"\n                                        state.config.list\n                                            .establecimientos_educacionales\n                                    \"\n                                    item-title=\"descripcion\"\n                                    item-value=\"id\"\n                                    v-model=\"\n                                        state.searchQuery\n                                            .establecimiento_educacional_id\n                                    \"\n                                    clearable\n                                    label=\"Establecimiento Educacional\"\n                                    class=\"ma-2\"\n                                    variant=\"underlined\"\n                                    single\n                                />\n                            </v-col>\n                        </v-row>\n\n                        <v-row>\n                            <v-btn\n                                prepend-icon=\"mdi-file-search\"\n                                variant=\"tonal\"\n                                class=\"ma-4\"\n                                color=\"#009AA4\"\n                                type=\"submit\"\n                                @click=\"buscar\"\n                                :loading=\"state.config.loading\"\n                            >\n                                Buscar\n                            </v-btn>\n\n                            <v-btn\n                                prepend-icon=\"mdi-cloud-download\"\n                                variant=\"tonal\"\n                                class=\"ma-4\"\n                                color=\"#009AA4\"\n                            >\n                                <download-excel\n                                    :data=\"state.tableItems\"\n                                    name=\"consulta_paciente.xls\"\n                                >\n                                    Bajar archivo\n                                </download-excel>\n                            </v-btn>\n                        </v-row>\n                    </v-form>\n                </v-expansion-panel-text>\n            </v-expansion-panel>\n        </v-expansion-panels>\n\n        <v-sheet color=\"white\" :elevation=\"4\" :class=\"'rounded-lg mt-4'\">\n            <DataTable\n                :headers=\"state.headers\"\n                :items=\"state.tableItems\"\n                @formCreate=\"handleFormCreate\"\n            />\n        </v-sheet>\n    </v-sheet>\n\n    <!--  <v-dialog v-model=\"dialog\" max-width=\"600px\">\n    <v-form ref=\"form\" @submit.prevent=\"submit\">\n      <v-card>\n        <v-card-title>\n          <span class=\"headline\">{{ formTitle }}</span>\n        </v-card-title>\n\n        <v-card-text>\n          <v-container>\n            <v-row>\n              <v-col cols=\"12\" sm=\"6\" md=\"4\" v-for=\"field in formFields\" :key=\"field.name\">\n                <v-text-field v-model=\"state.editedItem[field.name]\" :label=\"field.label\" :rules=\"field.rules\"\n                  required></v-text-field>\n              </v-col>\n            </v-row>\n          </v-container>\n        </v-card-text>\n\n        <v-card-actions>\n          <v-spacer></v-spacer>\n          <v-btn color=\"blue darken-1\" text @click=\"close\">Cancel</v-btn>\n          <v-btn color=\"blue darken-1\" text type=\"submit\">Save</v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-form>\n  </v-dialogger> -->\n</template>\n"],"names":[],"mappings":"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"}