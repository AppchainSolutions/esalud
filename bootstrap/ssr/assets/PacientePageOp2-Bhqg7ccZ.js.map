{"version":3,"file":"PacientePageOp2-Bhqg7ccZ.js","sources":["../../../resources/js/Pages/PacientePageOp2.vue"],"sourcesContent":["<script setup>\nimport AppLayout from \"../Layouts/AppLayout.vue\";\nimport { reactive, onMounted } from \"vue\";\nimport { useLogger } from \"vue-logger-plugin\";\nimport { fetchAllData, handleSearchItem } from \"../helper.js\";\nimport TableAction from \"./SubPages/Componentes/TableAction.vue\";\nimport { router } from \"@inertiajs/vue3\";\nimport { useDataStore } from \"@/store\";\n\ndefineOptions({ layout: AppLayout });\n\nconst store = useDataStore();\nconst logger = useLogger();\nconst state = reactive({\n    endpoints: [\n        \"calles\",\n        \"estados_civiles\",\n        \"establecimientos_educacionales\",\n        \"generos\",\n        \"grupos_sanguineos\",\n        \"nacionalidades\",\n        \"niveles_instruccion\",\n        \"previsiones\",\n        \"pueblos_originarios\",\n        \"religiones\",\n    ],\n\n    headers: [\n        { title: \"Rut\", align: \"center\", sortable: true, key: \"rut\" },\n        { title: \"Nombre\", align: \"center\", sortable: true, key: \"nombre\" },\n        {\n            title: \"Apellidos\",\n            align: \"center\",\n            sortable: true,\n            key: \"apellidos\",\n        },\n        {\n            title: \"Edad\",\n            align: \"center\",\n            sortable: true,\n            key: \"edad\",\n        },\n        {\n            title: \"Telefono contacto\",\n            align: \"center\",\n            sortable: true,\n            key: \"telefono1\",\n        },\n        { title: \"Acciones\", sortable: false, align: \"center\", key: \"actions\" },\n    ],\n\n    searchQuery: {\n        id: null,\n        rut: null,\n        rut_responsable: null,\n        establecimiento_educacional_id: null,\n    },\n\n    config: {\n        formName: \"frmPacientes\",\n        formItems: [],\n        editedIndex: -1,\n        loading: false,\n        tableItems: [],\n        formCrear: \"Nuevo Paciente\",\n        formEdit: \"Editar datos del Paciente\",\n        formTitle: \"GestiÃ³n de Pacientes\",\n        list: [],\n        route: \"paciente\",\n    },\n});\n\n/**\n * Fetches all data from the specified endpoints and updates the list configuration.\n * Logs the retrieved endpoints using the logger.\n */\nonMounted(async () => {\n    try {\n        state.config.list = await fetchAllData(state.endpoints);\n        if (state.config.list) {\n            store.setEndpoints({ ...state.config.list });\n        }\n    } catch (error) {\n        logger.error(\"Error loading endpoints:\", error);\n    }\n});\n\n/**\n * Initiates a search operation using the current search query and route.\n * Updates the table items with the search results and manages the loading state.\n * Logs the search query and the retrieved data.\n *\n * @returns {Promise<void>}\n */\nasync function buscar() {\n    state.config.loading = true;\n    state.config.tableItems = await handleSearchItem(\n        state.searchQuery,\n        state.config.route,\n    );\n    state.config.loading = false;\n}\n\nconst formCreate = () => {\n    try {\n        const result = router.get(\"paciente/create\", {\n            form_title: \"Nuevo paciente\",\n            form_id: \"frmPacientes\",\n            endpoints: state.config.list,\n        });\n        logger.log(\"result\", result);\n    } catch (error) {\n        logger.error(\"Error loading form items:\", error);\n    }\n};\n</script>\n\n<template>\n    <v-sheet :elevation=\"4\" :class=\"'rounded-lg ma-2 pa-2'\">\n        <v-expansion-panels>\n            <v-expansion-panel\n                title=\"Ficha de Pacientes\"\n                id=\"ficha\"\n                color=\"#009AA4\"\n            >\n                <v-expansion-panel-text>\n                    <v-form fast-fail @submit.prevent>\n                        <v-row>\n                            <v-col>\n                                <v-text-field\n                                    v-model=\"state.searchQuery.rut\"\n                                    label=\"Rut del paciente * (12345678-9)\"\n                                    class=\"ma-2\"\n                                    type=\"text\"\n                                    variant=\"underlined\"\n                                    clearable\n                                ></v-text-field>\n\n                                <v-text-field\n                                    v-model=\"state.searchQuery.rut_responsable\"\n                                    label=\"Rut persona encargada\"\n                                    class=\"ma-2\"\n                                    type=\"text\"\n                                    variant=\"underlined\"\n                                    clearable\n                                ></v-text-field>\n                            </v-col>\n                            <v-col>\n                                <!-- <v-select\n                                    :items=\"\n                                        state.config.list\n                                            .establecimientos_educacionales\n                                    \"\n                                    item-title=\"descripcion\"\n                                    item-value=\"id\"\n                                    v-model=\"\n                                        state.searchQuery\n                                            .establecimiento_educacional_id\n                                    \"\n                                    clearable\n                                    label=\"Establecimiento Educacional\"\n                                    class=\"ma-2\"\n                                    variant=\"underlined\"\n                                    single\n                                /> -->\n                            </v-col>\n                        </v-row>\n\n                        <v-row>\n                            <v-btn\n                                prepend-icon=\"mdi-file-search\"\n                                variant=\"tonal\"\n                                class=\"ma-4\"\n                                color=\"#009AA4\"\n                                type=\"submit\"\n                                @click=\"buscar\"\n                                :loading=\"state.config.loading\"\n                            >\n                                Buscar\n                            </v-btn>\n\n                            <v-btn\n                                prepend-icon=\"mdi-cloud-download\"\n                                variant=\"tonal\"\n                                class=\"ma-4\"\n                                color=\"#009AA4\"\n                            >\n                                <download-excel\n                                    :data=\"state.tableItems\"\n                                    name=\"consulta_paciente.xls\"\n                                >\n                                    Bajar archivo\n                                </download-excel>\n                            </v-btn>\n                        </v-row>\n                    </v-form>\n                </v-expansion-panel-text>\n            </v-expansion-panel>\n        </v-expansion-panels>\n\n        <v-sheet color=\"white\" :elevation=\"4\" :class=\"'rounded-lg mt-4'\">\n            <v-data-table\n                :headers=\"state.headers\"\n                :items=\"state.config.tableItems\"\n            >\n                <template v-slot:top>\n                    <v-toolbar flat>\n                        <v-btn\n                            icon=\"mdi-account-multiple-plus\"\n                            variant=\"tonal\"\n                            class=\"ma-2\"\n                            color=\"#009AA4\"\n                            @click=\"formCreate\"\n                        >\n                        </v-btn>\n                    </v-toolbar>\n                </template>\n\n                <template v-slot:item.actions=\"{ item }\">\n                    <table-action\n                        :items=\"item\"\n                        :icon=\"'mdi-stethoscope'\"\n                        :title=\"'Ficha Medica'\"\n                        :action-type=\"'editarFichaMedica'\"\n                    />\n                    <table-action\n                        :items=\"item\"\n                        :icon=\"'mdi-account-edit-outline'\"\n                        :title=\"'Ficha Personal'\"\n                        :action-type=\"'editarFichaPersonal'\"\n                    />\n                    <table-action\n                        :items=\"item\"\n                        :icon=\"'mdi-delete-outline'\"\n                        :title=\"'Borrar registro'\"\n                        :action-type=\"'eliminarRegistro'\"\n                    />\n                </template>\n            </v-data-table>\n        </v-sheet>\n    </v-sheet>\n</template>\n"],"names":[],"mappings":"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"}