import{x as ee,y as te,z as le,h as D,j as i,o as ae,c as oe,w as a,b as e,a as g,t as x,k as E,f as p,n as S,m as _,i as P,r as ne}from"./app-Cw_Vz0lM.js";import{A as ie}from"./AppLayout-BVSZgQ1N.js";import{f as re,c as h,S as de,o as se,a as ce,b as ue,d as me,e as pe}from"./helper-CRDvS7nw.js";import{u as fe}from"./store-BZuqkbyQ.js";import{h as ve}from"./moment-C5S46NFB.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";const be={class:"text-h6 ma-2"},ge={class:"text-h6 ma-2"},xe=Object.assign({layout:ie},{__name:"ProfesionalPage",setup(he){const y=fe(),t=ee({endpoints:["especialidades"],headers:[{title:"Rut",align:"center",sortable:!0,key:"rut"},{title:"Nombre",align:"center",sortable:!0,key:"nombre"},{title:"Apellidos",align:"center",sortable:!0,key:"apellidos"},{title:"Especialidad",align:"center",sortable:!0,key:"especialidad_id"},{title:"Acciones",sortable:!1,align:"center",key:"actions"}],validation:{rutRules:[n=>{if(!/^[0-9]+[-|‐]{1}[0-9kK]{1}$/.test(n))return!1;let s=n.split("-"),r=s[0],f=s[1].toLowerCase(),m=0,c=1;for(;r;r=Math.floor(r/10))c=(c+r%10*(9-m++%6))%11;let d=c?c-1:"k";return f===d?!0:"El rut no es válido. Por favor, verifique el formato y los dígitos."}],emailRules:[n=>n?!0:"Se necesita un email.",n=>/.+@.+\..+/.test(n)?!0:"El email debe ser válido."]},horario:{headers:[{text:"Día de la semana",align:"center",sortable:!0,value:"dia"},{text:"Hora inicio",align:"center",sortable:!0,value:"horaInicio"},{text:"Hora término",align:"center",sortable:!0,value:"horaTermino"},{text:"Disponible (S/N)",align:"center",sortable:!0,value:"disponible"}],items:[{dia:"Lunes",horaInicio:"08:00",horaTermino:"17:00",disponible:"S"},{dia:"Martes",horaInicio:"08:00",horaTermino:"17:00",disponible:"N"}]},searchQuery:{rut:null,especialidad_id:null},editedItem:{rut:null,nombre:null,apellidos:null,dirección:null,email:null,fecha_nacimiento:null,especialidad_id:null,telefono:null,vigente:!0},defaultItem:{rut:null,nombre:null,apellidos:null,dirección:null,email:null,fecha_nacimiento:null,especialidad_id:null,telefono:null,vigente:!0},dialog:!1,editedIndex:-1,formCrear:"Nuevo profesional",formEdit:"Editar datos del profesional",formItems:[],formTitle:"Gestión de Profesionales",list:[],loadingSearch:!1,tableItems:[]});te(),le(async()=>{t.list=await re(t.endpoints)});const T=D(()=>t.editedIndex===-1?t.formCrear:t.formEdit);D(()=>ve(t.editedItem.fecha_nacimiento).format("DD/MM/YYYY"));function N(n){y.selected=n;try{P.get("/ficha")}catch{console.error()}}function R(n){y.selected=n;try{P.get("/asignacion")}catch{}}function U(){h(t)}function M(n){let l=new Date,s=new Date(n);return l.getFullYear()-s.getFullYear()}const B=()=>{let n=t.editedItem.fecha_nacimiento,l=M(n);t.editedItem.edad=ne(l)},j=n=>Object.values(n).every(l=>l===null||l===""),F=()=>{j(t.searchQuery)?de.fire({title:"¿Quieres desplegar todos los registros?",text:"Esta acción puede tardar un poco.",icon:"warning",showCancelButton:!0,cancelButtonText:"Cancelar"}).then(n=>{n.isConfirmed?console.log("Desplegando todos los registros..."):console.log("Acción cancelada.")}):console.log(t.searchQuery)};function Q(){se(t)}function Y(){return t.editedIndex>-1?$():q()}const q=async()=>{await ce(t),h(t)};function O(n){ue(t,n),B()}const $=async()=>{await me(t),h(t)},L=async n=>{pe(t,n)};return(n,l)=>{const s=i("v-divider"),r=i("v-text-field"),f=i("v-select"),m=i("v-col"),c=i("v-row"),d=i("v-btn"),I=i("download-excel"),V=i("v-form"),A=i("v-sheet"),z=i("v-card-title"),k=i("v-spacer"),G=i("v-toolbar-title"),w=i("v-toolbar"),H=i("v-chip"),C=i("v-data-table"),K=i("v-card-text"),J=i("v-card-actions"),W=i("v-card"),X=i("v-dialog"),v=i("v-tooltip"),Z=i("v-container");return ae(),oe(Z,{fluid:""},{default:a(()=>[e(A,{color:"white",elevation:6,class:S("rounded-lg ma-2 pa-2")},{default:a(()=>[g("div",be,x(t.formTitle),1),e(s,{thickness:"4px",color:"#009AA4"}),e(V,{"fast-fail":"",onSubmit:l[1]||(l[1]=E(()=>{},["prevent"]))},{default:a(()=>[e(c,null,{default:a(()=>[e(m,null,{default:a(()=>[e(r,{modelValue:t.searchQuery.rut,"onUpdate:modelValue":l[0]||(l[0]=o=>t.searchQuery.rut=o),rules:t.validation.rutRules,label:"Rut* (12345678-9)",class:"ma-2",type:"text",variant:"underlined",clearable:""},null,8,["modelValue","rules"]),e(f,{items:t.list.especialidad,clearable:"",label:"Especialidad",class:"ma-2",variant:"underlined",single:""},null,8,["items"])]),_:1})]),_:1}),e(c,null,{default:a(()=>[e(d,{"prepend-icon":"mdi-file-search",variant:"tonal",class:"ma-4",color:"#009AA4",loading:t.loadingSearch,type:"submit",onClick:F},{default:a(()=>l[11]||(l[11]=[p(" Buscar ")])),_:1},8,["loading"]),e(d,{"prepend-icon":"mdi-cloud-download",variant:"tonal",class:"ma-4",color:"#009AA4"},{default:a(()=>[e(I,{data:t.tableItems,name:"consulta_paciente.xls"},{default:a(()=>l[12]||(l[12]=[p(" Bajar archivo ")])),_:1},8,["data"])]),_:1})]),_:1})]),_:1})]),_:1}),e(A,{color:"white",elevation:6,class:S("rounded-lg ma-2 pa-2")},{default:a(()=>[e(C,{headers:t.headers,items:t.tableItems,"sort-by":[{key:"apellidos",order:"asc"}]},{top:a(()=>[e(w,{flat:""},{default:a(()=>[e(d,{icon:"mdi-account-multiple-plus",variant:"tonal",class:"ma-2",color:"#009AA4",onClick:Q}),e(X,{modelValue:t.dialog,"onUpdate:modelValue":l[10]||(l[10]=o=>t.dialog=o),persistent:""},{default:a(()=>[e(V,{"fast-fail":"",onSubmit:l[9]||(l[9]=E(()=>{},["prevent"]))},{default:a(()=>[e(W,null,{default:a(()=>[e(z,null,{default:a(()=>[g("div",ge,x(T.value),1),e(s,{thickness:"4px",color:"#662d91"})]),_:1}),e(K,null,{default:a(()=>[l[14]||(l[14]=g("div",{class:"text-h6"}," Datos Personales ",-1)),e(k),e(c,null,{default:a(()=>[e(m,{cols:"3"},{default:a(()=>[e(r,{modelValue:t.editedItem.rut,"onUpdate:modelValue":l[2]||(l[2]=o=>t.editedItem.rut=o),label:"Rut* (12345678-9)",type:"text",required:"",clearable:"",variant:"underlined"},null,8,["modelValue"]),e(r,{modelValue:t.editedItem.nombre,"onUpdate:modelValue":l[3]||(l[3]=o=>t.editedItem.nombre=o),label:"Nombre*",type:"text",required:"",clearable:"",variant:"underlined"},null,8,["modelValue"]),e(r,{modelValue:t.editedItem.apellidos,"onUpdate:modelValue":l[4]||(l[4]=o=>t.editedItem.apellidos=o),label:"Apellidos*",required:"",type:"text",clearable:"",variant:"underlined"},null,8,["modelValue"]),e(r,{modelValue:t.editedItem.email,"onUpdate:modelValue":l[5]||(l[5]=o=>t.editedItem.email=o),rules:t.validationSchema.emailRules,label:"Email",type:"email",required:"",clearable:"",variant:"underlined"},null,8,["modelValue","rules"])]),_:1}),e(m,{cols:"3"},{default:a(()=>[e(r,{modelValue:t.editedItem.direccion,"onUpdate:modelValue":l[6]||(l[6]=o=>t.editedItem.direccion=o),label:"Dirección",clearable:"",variant:"underlined"},null,8,["modelValue"]),e(r,{label:"teléfono 1",modelValue:t.editedItem.telefono1,"onUpdate:modelValue":l[7]||(l[7]=o=>t.editedItem.telefono1=o),clearable:"",variant:"underlined"},null,8,["modelValue"]),e(r,{modelValue:t.editedItem.telefono2,"onUpdate:modelValue":l[8]||(l[8]=o=>t.editedItem.telefono2=o),label:"teléfono 2",clearable:"",variant:"underlined"},null,8,["modelValue"]),e(f,{items:["Psicologia","Kine","Terapia Ocupacional"],clearable:"",label:"Especialidad",variant:"underlined",single:""})]),_:1}),e(m,null,{default:a(()=>[e(C,{headers:t.horario.headers,items:t.horario.items,class:"elevation-1"},{top:a(()=>[e(w,{flat:""},{default:a(()=>[e(G,null,{default:a(()=>l[13]||(l[13]=[p("Disponibilidad horaria")])),_:1}),e(s,{class:"mx-4",inset:"",vertical:""})]),_:1})]),"item.disponible":a(({item:o})=>[e(H,{color:o.disponible==="S"?"green":"red",dark:""},{default:a(()=>[p(x(o.disponible),1)]),_:2},1032,["color"])]),_:1},8,["headers","items"])]),_:1})]),_:1})]),_:1}),e(J,null,{default:a(()=>[e(k),e(d,{color:"#009AA4",variant:"tonal",onClick:U},{default:a(()=>l[15]||(l[15]=[p(" Cancelar ")])),_:1}),e(d,{color:"#009AA4",variant:"tonal",onClick:Y},{default:a(()=>l[16]||(l[16]=[p(" Guardar ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":a(({item:o})=>[e(v,{text:"Asignacion de Servicio",location:"top"},{activator:a(({props:u})=>[e(d,_(u,{density:"compact",color:"#009AA4",class:"mr-2 ml-2",icon:"mdi-medical-bag",variant:"tonal",onClick:b=>R(o)}),null,16,["onClick"])]),_:2},1024),e(v,{text:"Ficha Médica",location:"top"},{activator:a(({props:u})=>[e(d,_(u,{density:"compact",color:"#009AA4",class:"mr-2 ml-2",variant:"tonal",icon:"mdi-stethoscope",onClick:b=>N(o)}),null,16,["onClick"])]),_:2},1024),e(v,{text:"Datos Personales",location:"top"},{activator:a(({props:u})=>[e(d,_(u,{density:"compact",class:"mr-2 ml-2",color:"#009AA4",variant:"tonal",icon:"mdi-account-edit-outline",onClick:b=>O(o)}),null,16,["onClick"])]),_:2},1024),e(v,{text:"Eliminar",location:"top"},{activator:a(({props:u})=>[e(d,_(u,{density:"compact",class:"mr-2 ml-2",color:"#009AA4",variant:"tonal",icon:"mdi-delete-outline",onClick:b=>L(o)}),null,16,["onClick"])]),_:2},1024)]),_:1},8,["headers","items"])]),_:1})]),_:1})}}}),Ce=_e(xe,[["__file","/home/blueshadows/www/esalud/resources/js/Pages/SubPages/ProfesionalPage.vue"]]);export{Ce as default};
//# sourceMappingURL=ProfesionalPage-BOYBIgTY.js.map
