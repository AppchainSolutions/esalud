import{x as N,y as E,j as n,o as B,c as F,w as o,b as l,f as y,t as k,n as P,m as j,a as R}from"./app-C1ZRqz2K.js";import{A as $}from"./AppLayout-BaBtGiTx.js";import{f as L,h as M}from"./helper-D_Lm4e5b.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./logo-DIp7Rf8v.js";import"./store-DPQZIGvL.js";const z={class:"text-h5"},G=Object.assign({layout:$},{__name:"ConsultaDiat",setup(K){const e=N({endpoints:["area","ceco","empresa","planta","unidad","accidente","seguro","tipo_accidente"],headers:[{title:"RUT",align:"center",sortable:!0,key:"rut"},{title:"Nombre",align:"center",sortable:!0,key:"nombre"},{title:"Apellidos",sortable:!0,align:"center",key:"apellidos"},{title:"Empresa",sortable:!0,align:"center",key:"empresa.descripcion"},{title:"Folio",align:"start",sortable:!0,key:"folio"},{title:"Tipo de accidente",align:"start",sortable:!0,key:"tipo_accidente.descripcion"},{title:"Planta",align:"start",sortable:!0,key:"planta.descripcion"},{title:"Fecha de admision",align:"start",sortable:!0,key:"fecha_admision"},{title:"Estatus",align:"start",sortable:!0,key:"estado_diat"},{title:"Acciones",align:"center",key:"actions"}],searchQuery:{activo:"true",area:null,ceco:null,empresa:null,planta:null,rut:null,unidad:null,tipo_accidente:null,estado_diat:"0",fecha_admision:{desde:null,hasta:null}},rutRules:[s=>{if(!/^[0-9]+[-|‐]{1}[0-9kK]{1}$/.test(s))return!1;let m=s.split("-"),r=m[0],V=m[1].toLowerCase(),c=0,i=1;for(;r;r=Math.floor(r/10))i=(i+r%10*(9-c++%6))%11;let d=i?i-1:"k";return V==d?!0:"El rut es incorrecto"}],itemsView:{paciente_id:null,accidente:null,seguro:null,comentario:null,estado_diat:null,fecha_admision:null,folio:null,idpgp:null,numero_resolucion:null,origen_denuncia:null,sucursal:null,tipo_accidente:null,validado_por:null},dialog:!1,tableItems:[],formItems:[],editedIndex:-1,loadingSearch:!1,list:[],valid:null,formTitle:"Consulta DIAT",urlSearch:"/consulta/diat/search"});E(async()=>{e.list=await L(e.endpoints)});function A(s){e.dialog=!0,e.itemsView={...s}}function h(){e.dialog=!1}const Q=async()=>{await M(e)};return(s,a)=>{const m=n("v-toolbar-title"),r=n("v-spacer"),V=n("v-toolbar"),c=n("v-card-title"),i=n("v-text-field"),d=n("v-select"),u=n("v-col"),f=n("v-switch"),g=n("v-row"),b=n("v-card-text"),p=n("v-btn"),C=n("download-excel"),w=n("v-card-actions"),_=n("v-container"),x=n("v-form"),D=n("v-tooltip"),S=n("v-data-table"),v=n("v-sheet"),U=n("v-card"),I=n("v-dialog");return B(),F(_,{fluid:""},{default:o(()=>[l(U,null,{default:o(()=>[l(c,null,{default:o(()=>[l(V,{flat:""},{default:o(()=>[l(m,null,{default:o(()=>[y(k(e.formTitle),1)]),_:1}),l(r)]),_:1})]),_:1}),l(b,null,{default:o(()=>[l(v,{color:"white",elevation:4,class:P("rounded-lg ma-2 pa-2")},{default:o(()=>[l(x,null,{default:o(()=>[l(_,{fluid:""},{default:o(()=>[l(b,null,{default:o(()=>[l(g,null,{default:o(()=>[l(u,null,{default:o(()=>[l(i,{label:"Rut",variant:"underlined",rules:e.rutRules,modelValue:e.searchQuery.rut,"onUpdate:modelValue":a[0]||(a[0]=t=>e.searchQuery.rut=t),clearable:""},null,8,["rules","modelValue"]),l(d,{label:"Empresa",variant:"underlined",modelValue:e.searchQuery.empresa,"onUpdate:modelValue":a[1]||(a[1]=t=>e.searchQuery.empresa=t),items:e.list.empresa,"item-title":"descripcion","item-value":"id",clearable:""},null,8,["modelValue","items"]),l(d,{label:"Unidad",variant:"underlined",modelValue:e.searchQuery.unidad,"onUpdate:modelValue":a[2]||(a[2]=t=>e.searchQuery.unidad=t),items:e.list.unidad,"item-title":"descripcion","item-value":"id",clearable:""},null,8,["modelValue","items"]),l(d,{label:"Area",modelValue:e.searchQuery.area,"onUpdate:modelValue":a[3]||(a[3]=t=>e.searchQuery.area=t),variant:"underlined",items:e.list.area,"item-title":"descripcion","item-value":"id",clearable:""},null,8,["modelValue","items"]),l(d,{label:"Area (cecos)",modelValue:e.searchQuery.ceco,"onUpdate:modelValue":a[4]||(a[4]=t=>e.searchQuery.ceco=t),variant:"underlined",items:e.list.ceco,"item-title":"descripcion","item-value":"id",clearable:""},null,8,["modelValue","items"])]),_:1}),l(u,null,{default:o(()=>[l(i,{label:"Fecha admision (desde)",variant:"underlined",modelValue:e.searchQuery.fecha_admision.desde,"onUpdate:modelValue":a[5]||(a[5]=t=>e.searchQuery.fecha_admision.desde=t),type:"date",clearable:""},null,8,["modelValue"]),l(i,{label:"Fecha admision (hasta)",variant:"underlined",type:"date",modelValue:e.searchQuery.fecha_admision.hasta,"onUpdate:modelValue":a[6]||(a[6]=t=>e.searchQuery.fecha_admision.hasta=t),clearable:""},null,8,["modelValue"]),l(f,{modelValue:e.searchQuery.activo,"onUpdate:modelValue":a[7]||(a[7]=t=>e.searchQuery.activo=t),"hide-details":"","true-value":"true","false-value":"false",class:"ml-4 mt-4",variant:"underlined",color:"green-darken-3",inset:"",label:"Activo"},null,8,["modelValue"]),l(f,{modelValue:e.searchQuery.estado_diat,"onUpdate:modelValue":a[8]||(a[8]=t=>e.searchQuery.estado_diat=t),"hide-details":"","true-value":"1","false-value":"0",class:"ml-4 mt-4",variant:"underlined",color:"green-darken-3",value:"0",inset:"",label:"Aprobado"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(w,null,{default:o(()=>[l(p,{"prepend-icon":"mdi-file-search",variant:"tonal",color:"#009AA4",loading:e.loadingSearch,onClick:a[9]||(a[9]=t=>Q())},{default:o(()=>a[22]||(a[22]=[y(" Buscar ")])),_:1},8,["loading"]),l(p,{"prepend-icon":"mdi-microsoft-excel",variant:"tonal",color:"#009AA4"},{default:o(()=>[l(C,{data:e.tableItems,name:"consulta_diat.xls"},{default:o(()=>a[23]||(a[23]=[y(" Bajar archivo ")])),_:1},8,["data"])]),_:1})]),_:1})]),_:1})]),_:1}),l(_,{fluid:""},{default:o(()=>[l(S,{headers:e.headers,items:e.tableItems,"sort-by":[{key:"apellidos",order:"asc"}]},{item:o(({item:t})=>[l(D,{text:"Ver detalles",location:"top"},{activator:o(({props:T})=>[l(p,j(T,{density:"compact",color:"#009AA4",class:"mr-2 ml-2",icon:"mdi-eye",onClick:q=>A(t)}),null,16,["onClick"])]),_:2},1024)]),_:1},8,["headers","items"])]),_:1})]),_:1})]),_:1})]),_:1}),l(x,{readonly:""},{default:o(()=>[l(_,null,{default:o(()=>[l(I,{modelValue:e.dialog,"onUpdate:modelValue":a[21]||(a[21]=t=>e.dialog=t)},{default:o(()=>[l(v,{elevation:"4",class:"ma-4 pa-4"},{default:o(()=>[l(U,null,{default:o(()=>[l(v,{elevation:"2",class:"ma-2 pa-2"},{default:o(()=>[l(c,null,{default:o(()=>[R("span",z,k(e.formTitle),1)]),_:1})]),_:1}),l(b,null,{default:o(()=>[l(g,null,{default:o(()=>[l(u,null,{default:o(()=>[l(i,{modelValue:e.itemsView.folio,"onUpdate:modelValue":a[10]||(a[10]=t=>e.itemsView.folio=t),label:"Folio",type:"number",variant:"underlined"},null,8,["modelValue"]),l(i,{modelValue:e.itemsView.idpgp,"onUpdate:modelValue":a[11]||(a[11]=t=>e.itemsView.idpgp=t),label:"IDPGP",type:"number",variant:"underlined"},null,8,["modelValue"]),l(d,{modelValue:e.itemsView.accidente,"onUpdate:modelValue":a[12]||(a[12]=t=>e.itemsView.accidente=t),items:e.list.accidente,"item-title":"descripcion","item-value":"id",label:"Accidente",variant:"underlined"},null,8,["modelValue","items"]),l(d,{modelValue:e.itemsView.seguro,"onUpdate:modelValue":a[13]||(a[13]=t=>e.itemsView.seguro=t),items:e.list.seguro,"item-title":"descripcion","item-value":"id",label:"Adm. Seguro de Vida",variant:"underlined"},null,8,["modelValue","items"])]),_:1}),l(u,null,{default:o(()=>[l(f,{modelValue:e.itemsView.estado_diat,"onUpdate:modelValue":a[14]||(a[14]=t=>e.itemsView.estado_diat=t),"hide-details":"","true-value":"Aprobado","false-value":"No Aprobado",variant:"underlined",color:"green-darken-3",value:"No Aprobado",inset:!0,label:`Estado Diat: ${e.itemsView.estado_diat.toString()}`},null,8,["modelValue","label"]),l(i,{modelValue:e.itemsView.fecha_admision,"onUpdate:modelValue":a[15]||(a[15]=t=>e.itemsView.fecha_admision=t),label:"fecha_admision",type:"date",variant:"underlined"},null,8,["modelValue"]),l(i,{modelValue:e.itemsView.numero_resolucion,"onUpdate:modelValue":a[16]||(a[16]=t=>e.itemsView.numero_resolucion=t),label:"Número de resolución",type:"number",variant:"underlined"},null,8,["modelValue"]),l(i,{modelValue:e.itemsView.origen_denuncia,"onUpdate:modelValue":a[17]||(a[17]=t=>e.itemsView.origen_denuncia=t),label:"Origen denuncia",type:"text",variant:"underlined"},null,8,["modelValue"])]),_:1}),l(u,null,{default:o(()=>[l(i,{modelValue:e.itemsView.sucursal,"onUpdate:modelValue":a[18]||(a[18]=t=>e.itemsView.sucursal=t),label:"Sucursal",type:"text",variant:"underlined"},null,8,["modelValue"]),l(d,{modelValue:e.itemsView.tipo_accidente,"onUpdate:modelValue":a[19]||(a[19]=t=>e.itemsView.tipo_accidente=t),label:"Tipo de accidente",variant:"underlined",items:e.list.tipo_accidente,"item-title":"descripcion","item-value":"id"},null,8,["modelValue","items"]),l(i,{modelValue:e.itemsView.validado_por,"onUpdate:modelValue":a[20]||(a[20]=t=>e.itemsView.validado_por=t),label:"Validado por",type:"text",variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(v,{elevation:"2",class:"ma-2 pa-2"},{default:o(()=>[l(w,null,{default:o(()=>[l(p,{class:"mr-2 ml-2",color:"#009AA4",text:"Cerrar",variant:"tonal",onClick:h})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})}}}),ee=O(G,[["__file","/home/blueshadows/www/esalud/resources/js/Pages/Consultas/ConsultaDiat.vue"]]);export{ee as default};
//# sourceMappingURL=ConsultaDiat-xsO--BSE.js.map
