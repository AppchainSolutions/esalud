{"version":3,"file":"TeamMemberManager-D3E6Guj_.js","sources":["../../../resources/js/Pages/Teams/Partials/TeamMemberManager.vue"],"sourcesContent":["<script setup>\nimport { ref } from 'vue';\nimport { router, useForm, usePage } from '@inertiajs/vue3';\nimport ActionMessage from '@/Components/ActionMessage.vue';\nimport ActionSection from '@/Components/ActionSection.vue';\nimport ConfirmationModal from '@/Components/ConfirmationModal.vue';\nimport DangerButton from '@/Components/DangerButton.vue';\nimport DialogModal from '@/Components/DialogModal.vue';\nimport FormSection from '@/Components/FormSection.vue';\nimport InputError from '@/Components/InputError.vue';\nimport InputLabel from '@/Components/InputLabel.vue';\nimport PrimaryButton from '@/Components/PrimaryButton.vue';\nimport SecondaryButton from '@/Components/SecondaryButton.vue';\nimport SectionBorder from '@/Components/SectionBorder.vue';\nimport TextInput from '@/Components/TextInput.vue';\n\nconst props = defineProps({\n    team: Object,\n    availableRoles: Array,\n    userPermissions: Object,\n});\n\nconst page = usePage();\n\nconst addTeamMemberForm = useForm({\n    email: '',\n    role: null,\n});\n\nconst updateRoleForm = useForm({\n    role: null,\n});\n\nconst leaveTeamForm = useForm({});\nconst removeTeamMemberForm = useForm({});\n\nconst currentlyManagingRole = ref(false);\nconst managingRoleFor = ref(null);\nconst confirmingLeavingTeam = ref(false);\nconst teamMemberBeingRemoved = ref(null);\n\nconst addTeamMember = () => {\n    addTeamMemberForm.post(route('team-members.store', props.team), {\n        errorBag: 'addTeamMember',\n        preserveScroll: true,\n        onSuccess: () => addTeamMemberForm.reset(),\n    });\n};\n\nconst cancelTeamInvitation = (invitation) => {\n    router.delete(route('team-invitations.destroy', invitation), {\n        preserveScroll: true,\n    });\n};\n\nconst manageRole = (teamMember) => {\n    managingRoleFor.value = teamMember;\n    updateRoleForm.role = teamMember.membership.role;\n    currentlyManagingRole.value = true;\n};\n\nconst updateRole = () => {\n    updateRoleForm.put(route('team-members.update', [props.team, managingRoleFor.value]), {\n        preserveScroll: true,\n        onSuccess: () => currentlyManagingRole.value = false,\n    });\n};\n\nconst confirmLeavingTeam = () => {\n    confirmingLeavingTeam.value = true;\n};\n\nconst leaveTeam = () => {\n    leaveTeamForm.delete(route('team-members.destroy', [props.team, page.props.auth.user]));\n};\n\nconst confirmTeamMemberRemoval = (teamMember) => {\n    teamMemberBeingRemoved.value = teamMember;\n};\n\nconst removeTeamMember = () => {\n    removeTeamMemberForm.delete(route('team-members.destroy', [props.team, teamMemberBeingRemoved.value]), {\n        errorBag: 'removeTeamMember',\n        preserveScroll: true,\n        preserveState: true,\n        onSuccess: () => teamMemberBeingRemoved.value = null,\n    });\n};\n\nconst displayableRole = (role) => {\n    return props.availableRoles.find(r => r.key === role).name;\n};\n</script>\n\n<template>\n    <div>\n        <div v-if=\"userPermissions.canAddTeamMembers\">\n            <SectionBorder />\n\n            <!-- Add Team Member -->\n            <FormSection @submitted=\"addTeamMember\">\n                <template #title>\n                    Add Team Member\n                </template>\n\n                <template #description>\n                    Add a new team member to your team, allowing them to collaborate with you.\n                </template>\n\n                <template #form>\n                    <div class=\"col-span-6\">\n                        <div class=\"max-w-xl text-sm text-gray-600\">\n                            Please provide the email address of the person you would like to add to this team.\n                        </div>\n                    </div>\n\n                    <!-- Member Email -->\n                    <div class=\"col-span-6 sm:col-span-4\">\n                        <InputLabel for=\"email\" value=\"Email\" />\n                        <TextInput\n                            id=\"email\"\n                            v-model=\"addTeamMemberForm.email\"\n                            type=\"email\"\n                            class=\"mt-1 block w-full\"\n                        />\n                        <InputError :message=\"addTeamMemberForm.errors.email\" class=\"mt-2\" />\n                    </div>\n\n                    <!-- Role -->\n                    <div v-if=\"availableRoles.length > 0\" class=\"col-span-6 lg:col-span-4\">\n                        <InputLabel for=\"roles\" value=\"Role\" />\n                        <InputError :message=\"addTeamMemberForm.errors.role\" class=\"mt-2\" />\n\n                        <div class=\"relative z-0 mt-1 border border-gray-200 rounded-lg cursor-pointer\">\n                            <button\n                                v-for=\"(role, i) in availableRoles\"\n                                :key=\"role.key\"\n                                type=\"button\"\n                                class=\"relative px-4 py-3 inline-flex w-full rounded-lg focus:z-10 focus:outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500\"\n                                :class=\"{'border-t border-gray-200 focus:border-none rounded-t-none': i > 0, 'rounded-b-none': i != Object.keys(availableRoles).length - 1}\"\n                                @click=\"addTeamMemberForm.role = role.key\"\n                            >\n                                <div :class=\"{'opacity-50': addTeamMemberForm.role && addTeamMemberForm.role != role.key}\">\n                                    <!-- Role Name -->\n                                    <div class=\"flex items-center\">\n                                        <div class=\"text-sm text-gray-600\" :class=\"{'font-semibold': addTeamMemberForm.role == role.key}\">\n                                            {{ role.name }}\n                                        </div>\n\n                                        <svg v-if=\"addTeamMemberForm.role == role.key\" class=\"ms-2 h-5 w-5 text-green-400\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\">\n                                            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                                        </svg>\n                                    </div>\n\n                                    <!-- Role Description -->\n                                    <div class=\"mt-2 text-xs text-gray-600 text-start\">\n                                        {{ role.description }}\n                                    </div>\n                                </div>\n                            </button>\n                        </div>\n                    </div>\n                </template>\n\n                <template #actions>\n                    <ActionMessage :on=\"addTeamMemberForm.recentlySuccessful\" class=\"me-3\">\n                        Added.\n                    </ActionMessage>\n\n                    <PrimaryButton :class=\"{ 'opacity-25': addTeamMemberForm.processing }\" :disabled=\"addTeamMemberForm.processing\">\n                        Add\n                    </PrimaryButton>\n                </template>\n            </FormSection>\n        </div>\n\n        <div v-if=\"team.team_invitations.length > 0 && userPermissions.canAddTeamMembers\">\n            <SectionBorder />\n\n            <!-- Team Member Invitations -->\n            <ActionSection class=\"mt-10 sm:mt-0\">\n                <template #title>\n                    Pending Team Invitations\n                </template>\n\n                <template #description>\n                    These people have been invited to your team and have been sent an invitation email. They may join the team by accepting the email invitation.\n                </template>\n\n                <!-- Pending Team Member Invitation List -->\n                <template #content>\n                    <div class=\"space-y-6\">\n                        <div v-for=\"invitation in team.team_invitations\" :key=\"invitation.id\" class=\"flex items-center justify-between\">\n                            <div class=\"text-gray-600\">\n                                {{ invitation.email }}\n                            </div>\n\n                            <div class=\"flex items-center\">\n                                <!-- Cancel Team Invitation -->\n                                <button\n                                    v-if=\"userPermissions.canRemoveTeamMembers\"\n                                    class=\"cursor-pointer ms-6 text-sm text-red-500 focus:outline-none\"\n                                    @click=\"cancelTeamInvitation(invitation)\"\n                                >\n                                    Cancel\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </template>\n            </ActionSection>\n        </div>\n\n        <div v-if=\"team.users.length > 0\">\n            <SectionBorder />\n\n            <!-- Manage Team Members -->\n            <ActionSection class=\"mt-10 sm:mt-0\">\n                <template #title>\n                    Team Members\n                </template>\n\n                <template #description>\n                    All of the people that are part of this team.\n                </template>\n\n                <!-- Team Member List -->\n                <template #content>\n                    <div class=\"space-y-6\">\n                        <div v-for=\"user in team.users\" :key=\"user.id\" class=\"flex items-center justify-between\">\n                            <div class=\"flex items-center\">\n                                <img class=\"w-8 h-8 rounded-full object-cover\" :src=\"user.profile_photo_url\" :alt=\"user.name\">\n                                <div class=\"ms-4\">\n                                    {{ user.name }}\n                                </div>\n                            </div>\n\n                            <div class=\"flex items-center\">\n                                <!-- Manage Team Member Role -->\n                                <button\n                                    v-if=\"userPermissions.canUpdateTeamMembers && availableRoles.length\"\n                                    class=\"ms-2 text-sm text-gray-400 underline\"\n                                    @click=\"manageRole(user)\"\n                                >\n                                    {{ displayableRole(user.membership.role) }}\n                                </button>\n\n                                <div v-else-if=\"availableRoles.length\" class=\"ms-2 text-sm text-gray-400\">\n                                    {{ displayableRole(user.membership.role) }}\n                                </div>\n\n                                <!-- Leave Team -->\n                                <button\n                                    v-if=\"$page.props.auth.user.id === user.id\"\n                                    class=\"cursor-pointer ms-6 text-sm text-red-500\"\n                                    @click=\"confirmLeavingTeam\"\n                                >\n                                    Leave\n                                </button>\n\n                                <!-- Remove Team Member -->\n                                <button\n                                    v-else-if=\"userPermissions.canRemoveTeamMembers\"\n                                    class=\"cursor-pointer ms-6 text-sm text-red-500\"\n                                    @click=\"confirmTeamMemberRemoval(user)\"\n                                >\n                                    Remove\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </template>\n            </ActionSection>\n        </div>\n\n        <!-- Role Management Modal -->\n        <DialogModal :show=\"currentlyManagingRole\" @close=\"currentlyManagingRole = false\">\n            <template #title>\n                Manage Role\n            </template>\n\n            <template #content>\n                <div v-if=\"managingRoleFor\">\n                    <div class=\"relative z-0 mt-1 border border-gray-200 rounded-lg cursor-pointer\">\n                        <button\n                            v-for=\"(role, i) in availableRoles\"\n                            :key=\"role.key\"\n                            type=\"button\"\n                            class=\"relative px-4 py-3 inline-flex w-full rounded-lg focus:z-10 focus:outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500\"\n                            :class=\"{'border-t border-gray-200 focus:border-none rounded-t-none': i > 0, 'rounded-b-none': i !== Object.keys(availableRoles).length - 1}\"\n                            @click=\"updateRoleForm.role = role.key\"\n                        >\n                            <div :class=\"{'opacity-50': updateRoleForm.role && updateRoleForm.role !== role.key}\">\n                                <!-- Role Name -->\n                                <div class=\"flex items-center\">\n                                    <div class=\"text-sm text-gray-600\" :class=\"{'font-semibold': updateRoleForm.role === role.key}\">\n                                        {{ role.name }}\n                                    </div>\n\n                                    <svg v-if=\"updateRoleForm.role == role.key\" class=\"ms-2 h-5 w-5 text-green-400\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\">\n                                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                                    </svg>\n                                </div>\n\n                                <!-- Role Description -->\n                                <div class=\"mt-2 text-xs text-gray-600\">\n                                    {{ role.description }}\n                                </div>\n                            </div>\n                        </button>\n                    </div>\n                </div>\n            </template>\n\n            <template #footer>\n                <SecondaryButton @click=\"currentlyManagingRole = false\">\n                    Cancel\n                </SecondaryButton>\n\n                <PrimaryButton\n                    class=\"ms-3\"\n                    :class=\"{ 'opacity-25': updateRoleForm.processing }\"\n                    :disabled=\"updateRoleForm.processing\"\n                    @click=\"updateRole\"\n                >\n                    Save\n                </PrimaryButton>\n            </template>\n        </DialogModal>\n\n        <!-- Leave Team Confirmation Modal -->\n        <ConfirmationModal :show=\"confirmingLeavingTeam\" @close=\"confirmingLeavingTeam = false\">\n            <template #title>\n                Leave Team\n            </template>\n\n            <template #content>\n                Are you sure you would like to leave this team?\n            </template>\n\n            <template #footer>\n                <SecondaryButton @click=\"confirmingLeavingTeam = false\">\n                    Cancel\n                </SecondaryButton>\n\n                <DangerButton\n                    class=\"ms-3\"\n                    :class=\"{ 'opacity-25': leaveTeamForm.processing }\"\n                    :disabled=\"leaveTeamForm.processing\"\n                    @click=\"leaveTeam\"\n                >\n                    Leave\n                </DangerButton>\n            </template>\n        </ConfirmationModal>\n\n        <!-- Remove Team Member Confirmation Modal -->\n        <ConfirmationModal :show=\"teamMemberBeingRemoved\" @close=\"teamMemberBeingRemoved = null\">\n            <template #title>\n                Remove Team Member\n            </template>\n\n            <template #content>\n                Are you sure you would like to remove this person from the team?\n            </template>\n\n            <template #footer>\n                <SecondaryButton @click=\"teamMemberBeingRemoved = null\">\n                    Cancel\n                </SecondaryButton>\n\n                <DangerButton\n                    class=\"ms-3\"\n                    :class=\"{ 'opacity-25': removeTeamMemberForm.processing }\"\n                    :disabled=\"removeTeamMemberForm.processing\"\n                    @click=\"removeTeamMember\"\n                >\n                    Remove\n                </DangerButton>\n            </template>\n        </ConfirmationModal>\n    </div>\n</template>\n"],"names":[],"mappings":"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"}